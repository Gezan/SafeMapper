version: 1.0.{build}
before_build:
  - nuget restore ".\SafeMapper.sln"  
build:
  project: .\SafeMapper.sln
  publish_nuget: true
  verbosity: minimal
artifacts:
- path: '*.nupkg'
  name: Nuget
environment:
    COVERALLS_REPO_TOKEN:  
       secure: K+fCPAUxXxW0g4oxV+/Y8oYyiiYKagU4gOQ9SRP5AH9Si3uACrS4D1kKxOsXs/Bp
test_script:
- ps: >-
    .\packages\OpenCover.4.5.3522\OpenCover.Console.exe -register:user -target:packages\NUnit.Runners.2.6.4\tools\nunit-console.exe -targetargs:"SafeMapper.Tests\bin\$env:CONFIGURATION\SafeMapper.Tests.dll /noshadow /xml=coverage\TestResult.xml" -filter:"+[SafeMapper*]* -[SafeMapper.Tests*]*" -output:coverage\opencovertests.xml
    .\packages\coveralls.net.0.5.0\csmacnz.Coveralls.exe --opencover -i coverage\opencovertests.xml --repoToken $env:COVERALLS_REPO_TOKEN --commitId $env:APPVEYOR_REPO_COMMIT --commitBranch $env:APPVEYOR_REPO_BRANCH --commitAuthor $env:APPVEYOR_REPO_COMMIT_AUTHOR --commitEmail $env:APPVEYOR_REPO_COMMIT_AUTHOR_EMAIL --commitMessage $env:APPVEYOR_REPO_COMMIT_MESSAGE --jobId $env:APPVEYOR_JOB_ID